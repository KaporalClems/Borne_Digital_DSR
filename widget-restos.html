<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Widget Restaurants</title>
    <!-- Utilisation de Tailwind CSS pour un style moderne et responsive -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Importation de la librairie Swiper pour le carrousel -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <style>
        /* Styles personnalisés pour la mise en page générale du widget */
        .widget-card {
            max-width: 600px;
            margin: auto;
            border-radius: 1rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        /* Swiper container - le cœur du carrousel */
        .swiper-container {
            width: 100%;
            height: 350px; /* Hauteur fixe pour éviter les barres de défilement */
        }

        .swiper-slide {
            display: flex;
            flex-direction: column;
            justify-content: flex-end; /* Alignement du contenu en bas */
            align-items: center;
            text-align: center;
            color: white;
            padding: 1rem;
            box-sizing: border-box;
            background-size: cover;
            background-position: center;
        }

        /* Overlay pour améliorer la lisibilité du texte sur l'image */
        .slide-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to top, rgba(0,0,0,0.7), rgba(0,0,0,0));
        }

        /* Style des contrôles de navigation */
        .swiper-button-prev,
        .swiper-button-next {
            color: white !important;
            --swiper-navigation-size: 20px;
            background-color: rgba(0,0,0,0.5);
            border-radius: 50%;
            padding: 10px;
        }
        
        .swiper-pagination-bullet {
            background: white !important;
            opacity: 0.8 !important;
        }

        /* Style des informations sur le restaurant */
        .resto-info {
            position: relative;
            z-index: 10;
            margin-top: auto;
        }
    </style>
</head>
<body class="bg-gray-100 font-sans p-6">

    <h2 class="text-2xl font-bold text-center mb-6 text-gray-800">Nos Restaurants Locaux</h2>

    <!-- Conteneur principal du widget -->
    <div class="widget-card bg-white">
        <!-- Swiper -->
        <div class="swiper swiper-container">
            <div class="swiper-wrapper" id="resto-container">
                <!-- Les slides des restaurants seront insérées ici par JavaScript -->
            </div>
            <!-- Pagination -->
            <div class="swiper-pagination"></div>
            <!-- Boutons de navigation -->
            <div class="swiper-button-prev"></div>
            <div class="swiper-button-next"></div>
        </div>
    </div>

    <!-- Importation du script Swiper -->
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script>
        // Fonction asynchrone pour récupérer les données et les afficher
        async function fetchRestaurants() {
            try {
                // Utilisation du lien GitHub pour le fichier JSON
                const response = await fetch("https://raw.githubusercontent.com/KaporalClems/Borne_Digital_DSR/14f976e05c3bace4722469792bbc7f914a27938c/restaurants.json");
                
                // Vérification de la réponse HTTP
                if (!response.ok) {
                    throw new Error(`Erreur HTTP: ${response.status}`);
                }
                
                const restos = await response.json();
                
                const container = document.getElementById('resto-container');
                
                // Parcours de la liste des restaurants pour créer les slides
                restos.forEach(resto => {
                    const slide = document.createElement('div');
                    slide.className = 'swiper-slide';
                    slide.style.backgroundImage = `url(${resto.image})`;
                    
                    slide.innerHTML = `
                        <div class="slide-overlay"></div>
                        <div class="resto-info">
                            <h3 class="text-3xl font-bold">${resto.name}</h3>
                            <p class="text-xl mt-2">${resto.commune}</p>
                        </div>
                    `;
                    container.appendChild(slide);
                });

                // Initialisation de Swiper après l'ajout des slides
                const swiper = new Swiper('.swiper-container', {
                    loop: true,
                    autoplay: {
                        delay: 5000,
                        disableOnInteraction: false,
                    },
                    effect: 'fade', // Ajoute un effet de transition pour le carrousel
                    fadeEffect: {
                        crossFade: true
                    },
                    pagination: {
                        el: '.swiper-pagination',
                        clickable: true,
                    },
                    navigation: {
                        nextEl: '.swiper-button-next',
                        prevEl: '.swiper-button-prev',
                    },
                });

            } catch (error) {
                console.error("Erreur lors du chargement des restaurants :", error);
                const container = document.getElementById('resto-container');
                container.innerHTML = `<div class="swiper-slide bg-gray-200 flex justify-center items-center"><p class="text-center text-red-500">Impossible de charger les restaurants. Vérifiez l'URL.</p></div>`;
            }
        }
        
        // Appel de la fonction pour afficher les restaurants au chargement de la page
        document.addEventListener('DOMContentLoaded', fetchRestaurants);
    </script>
</body>
</html>
