<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Borne Numérique Destination Sud Réunion</title>
    <link rel="manifest" href="manifest.json">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* Styles personnalisés pour la borne */
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }

        /* Conteneur pour la vidéo de fond */
        .background-video-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -100;
            overflow: hidden; /* Cache les débordements de l'iframe */
        }

        /* Vidéo de fond */
        #background-video {
            position: absolute;
            top: 50%;
            left: 50%;
            min-width: 100%;
            min-height: 100%;
            width: auto;
            height: auto;
            transform: translate(-50%, -50%);
            filter: brightness(0.7); /* Assombrir l'image pour une meilleure lisibilité */
        }

        .overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.4);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            color: white;
            padding: 20px;
        }
        
        .language-switcher {
            position: absolute;
            bottom: 20px;
            right: 20px;
            z-index: 100;
        }
        
        .language-switcher img {
            width: 40px;
            height: 40px;
            cursor: pointer;
            border-radius: 50%;
            border: 2px solid transparent;
            transition: border-color 0.3s ease;
        }

        .language-switcher img:hover {
            border-color: white;
        }

        .top-left-logo {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 100;
        }

        .top-left-logo img {
            height: 50px;
        }

        .icon-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            max-width: 90%;
            margin-top: 20px;
        }

        .icon-button {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
            max-width: 120px;
            aspect-ratio: 1 / 1;
            padding: 1rem;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 1rem;
            color: white;
            font-weight: bold;
            text-align: center;
            transition: transform 0.2s, background-color 0.2s;
        }

        .icon-button:hover {
            transform: scale(1.05);
            background-color: rgba(255, 255, 255, 0.3);
        }

        .icon-button svg {
            width: 50px;
            height: 50px;
            margin-bottom: 0.5rem;
            stroke: white;
            fill: none;
            stroke-width: 2;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .fade-in {
            animation: fadeIn 1s ease-in;
        }

    </style>
</head>
<body class="bg-gray-900 text-white flex items-center justify-center min-h-screen">
    <!-- Conteneur pour la vidéo de fond gérée par JS -->
    <div class="background-video-container">
        <!-- Remplacement de l'iframe par la balise <video> pour la lecture locale -->
        <video id="background-video" autoplay muted loop playsinline>
            <source src="Destination Sud Réunion_HD.mp4" type="video/mp4">
            Votre navigateur ne supporte pas la vidéo en arrière-plan.
        </video>
    </div>
    
    <!-- Top-left logo -->
    <div class="top-left-logo">
        <img src="https://srias.re/wp-content/uploads/2020/12/Destination-Sud-Reunion-png-1-min.png" alt="Logo Destination Sud Réunion">
    </div>

    <!-- Langues Switcher -->
    <div class="language-switcher flex space-x-4">
        <img id="lang-fr" src="https://flagcdn.com/w40/fr.png" alt="Drapeau Français" data-lang="fr">
        <img id="lang-en" src="https://flagcdn.com/w40/gb.png" alt="Drapeau Anglais" data-lang="en">
        <img id="lang-es" src="https://flagcdn.com/w40/es.png" alt="Drapeau Espagnol" data-lang="es">
        <img id="lang-de" src="https://flagcdn.com/w40/de.png" alt="Drapeau Allemand" data-lang="de">
    </div>

    <!-- Page de démarrage -->
    <div id="start-page" class="overlay fade-in">
        <div class="flex flex-col items-center p-8 rounded-lg shadow-xl bg-gray-800 bg-opacity-70 max-w-xl w-full">
            <h1 id="start-title" class="text-3xl md:text-5xl font-bold mb-4">Bienvenue</h1>
            <p id="start-subtitle" class="text-lg md:text-xl mb-8">Veuillez sélectionner votre code postal pour continuer.</p>
            
            <!-- Liste déroulante des codes postaux -->
            <div class="w-full">
                <select id="zip-code-select" class="w-full p-3 rounded-lg bg-gray-700 text-white border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300">
                    <option value="" disabled selected>Sélectionner un code postal</option>
                    <option value="97410">Saint-Pierre (97410)</option>
                    <option value="97427">L'Étang-Salé (97427)</option>
                    <option value="97436">Saint-Leu (97436)</option>
                    <option value="97480">Saint-Joseph (97480)</option>
                    <option value="97413">Cilaos (97413)</option>
                    <option value="97416">Entre-Deux (97416)</option>
                    <option value="97421">La Rivière Saint-Louis (97421)</option>
                    <option value="97424">Piton Saint-Leu (97424)</option>
                    <option value="97425">Les Avirons (97425)</option>
                    <option value="97426">Les Trois-Bassins (97426)</option>
                    <option value="97434">Saint-Gilles les Bains (97434)</option>
                    <option value="97441">Saint-Paul (97441)</option>
                    <option value="97442">Saint-Louis (97442)</option>
                    <option value="97443">Le Tampon (97443)</option>
                    <option value="97445">Saint-Gilles les Hauts (97445)</option>
                    <option value="97446">Saint-André (97446)</option>
                    <option value="97447">Saint-Benoît (97447)</option>
                    <option value="97450">Saint-Louis (97450)</option>
                    <option value="97460">Saint-Paul (97460)</option>
                    <option value="97470">Saint-Gilles les Bains (97470)</option>
                    <option value="97480">Saint-Joseph (97480)</option>
                    <option value="97490">Sainte-Clotilde (97490)</option>
                    <option value="97491">Sainte-Marie (97491)</option>
                    <option value="97492">Saint-Denis (97492)</option>
                    <option value="97493">Le Port (97493)</option>
                    <option value="97494">Saint-Paul (97494)</option>
                    <option value="97495">Sainte-Suzanne (97495)</option>
                </select>
            </div>

            <!-- Bouton pour accéder à la page d'accueil -->
            <button id="enter-button" disabled class="mt-6 w-full py-3 px-6 rounded-lg bg-emerald-500 text-white font-bold text-lg hover:bg-emerald-600 transition duration-300 transform hover:scale-105 disabled:bg-gray-500 disabled:cursor-not-allowed">
                Entrer
            </button>
        </div>
    </div>

    <!-- Contenu principal qui sera affiché après la sélection du code postal -->
    <div id="main-content" class="hidden overlay fade-in">
        <h1 id="city-title" class="text-4xl md:text-5xl font-bold mb-8"></h1>
        <div class="icon-grid">
            <!-- Boutons de la borne -->
            <a href="#" class="icon-button" data-type="see">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                </svg>
                <span id="label-see">À voir / À faire</span>
            </a>
            <a href="#" class="icon-button" data-type="sleep">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                </svg>
                <span id="label-sleep">Où dormir ?</span>
            </a>
            <a href="#" class="icon-button" data-type="eat">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                </svg>
                <span id="label-eat">Où manger ?</span>
            </a>
            <a href="#" class="icon-button" data-type="agenda">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                </svg>
                <span id="label-agenda">Agenda</span>
            </a>
            <a href="#" class="icon-button" data-type="forecast">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.927A5.002 5.002 0 0012 6c-2.457 0-4.783 1.149-6.322 2.972l-.337.351-1.396.985A1 1 0 003 15z" />
                </svg>
                <span id="label-forecast">Météo & marée</span>
            </a>
            <a href="#" class="icon-button" data-type="map">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                </svg>
                <span id="label-map">Carte interactive</span>
            </a>
            <a href="#" class="icon-button" data-type="outings">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" />
                </svg>
                <span id="label-outings">Sorties possibles</span>
            </a>
            <a href="#" class="icon-button" data-type="news">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h12a2 2 0 012 2v12a2 2 0 01-2 2z" />
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 12V9m0 3a2 2 0 100 4 2 2 0 000-4z" />
                </svg>
                <span id="label-news">Actualités</span>
            </a>
            <a href="#" class="icon-button" data-type="transport">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14v4m0 0a2 2 0 100-4 2 2 0 000 4zm0-10v4m0 0a2 2 0 100-4 2 2 0 000 4z" />
                </svg>
                <span id="label-transport">Transports</span>
            </a>
        </div>
        <!-- Bouton de retour commun à toutes les pages de ville -->
        <button id="back-button" class="mt-8 py-2 px-4 rounded-lg bg-gray-500 text-white font-bold hover:bg-gray-600 transition duration-300">
            Retour
        </button>
    </div>

    <!-- Script JavaScript pour la logique de l'application -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const startPage = document.getElementById('start-page');
            const mainContent = document.getElementById('main-content');
            const zipCodeSelect = document.getElementById('zip-code-select');
            const enterButton = document.getElementById('enter-button');
            const backButton = document.getElementById('back-button');
            const cityTitle = document.getElementById('city-title');

            // Éléments de texte à traduire
            const textElements = {
                'start-title': {'fr': 'Bienvenue', 'en': 'Welcome', 'es': 'Bienvenido', 'de': 'Willkommen'},
                'start-subtitle': {'fr': 'Veuillez sélectionner votre code postal pour continuer.', 'en': 'Please select your zip code to continue.', 'es': 'Por favor, seleccione su código postal para continuar.', 'de': 'Bitte wählen Sie Ihre Postleitzahl aus, um fortzufahren.'},
                'enter-button': {'fr': 'Entrer', 'en': 'Enter', 'es': 'Entrar', 'de': 'Eingeben'},
                'label-see': {'fr': 'À voir / À faire', 'en': 'To see / To do', 'es': 'Para ver / Para hacer', 'de': 'Sehenswert / Aktivitäten'},
                'label-sleep': {'fr': 'Où dormir ?', 'en': 'Where to sleep?', 'es': '¿Dónde dormir?', 'de': 'Wo übernachten?'},
                'label-eat': {'fr': 'Où manger ?', 'en': 'Where to eat?', 'es': '¿Dónde comer?', 'de': 'Wo essen?'},
                'label-agenda': {'fr': 'Agenda', 'en': 'Agenda', 'es': 'Agenda', 'de': 'Agenda'},
                'label-forecast': {'fr': 'Météo & marée', 'en': 'Weather & tide', 'es': 'Clima y marea', 'de': 'Wetter & Gezeiten'},
                'label-map': {'fr': 'Carte interactive', 'en': 'Interactive map', 'es': 'Mapa interactivo', 'de': 'Interaktive Karte'},
                'label-outings': {'fr': 'Sorties possibles', 'en': 'Possible outings', 'es': 'Posibles salidas', 'de': 'Mögliche Ausflüge'},
                'label-news': {'fr': 'Actualités', 'en': 'News', 'es': 'Noticias', 'de': 'Aktuelles'},
                'label-transport': {'fr': 'Transports', 'en': 'Transport', 'es': 'Transporte', 'de': 'Transport'},
                'back-button': {'fr': 'Retour', 'en': 'Back', 'es': 'Volver', 'de': 'Zurück'},
                'select-option': {'fr': 'Sélectionner un code postal', 'en': 'Select a zip code', 'es': 'Seleccionar un código postal', 'de': 'Wählen Sie eine Postleitzahl'}
            };
            
            // Mapping des codes postaux aux noms de villes
            const cityNames = {
                '97410': 'Saint-Pierre',
                '97427': 'L\'Étang-Salé',
                '97442': 'Saint-Louis',
                '97425': 'Les Avirons',
                '97480': 'Petite-Île',
            };

            // Fonction pour changer la langue
            function setLanguage(lang) {
                document.documentElement.lang = lang;
                document.getElementById('start-title').textContent = textElements['start-title'][lang];
                document.getElementById('start-subtitle').textContent = textElements['start-subtitle'][lang];
                document.getElementById('enter-button').textContent = textElements['enter-button'][lang];
                document.getElementById('back-button').textContent = textElements['back-button'][lang];
                zipCodeSelect.options[0].textContent = textElements['select-option'][lang];

                const buttons = document.querySelectorAll('.icon-button span');
                buttons.forEach(span => {
                    const id = span.id.replace(/-974\d{2}$/, ''); 
                    if (textElements[id]) {
                        span.textContent = textElements[id][lang];
                    }
                });
            }

            // Gestionnaire d'événements pour les drapeaux
            document.getElementById('lang-fr').addEventListener('click', () => setLanguage('fr'));
            document.getElementById('lang-en').addEventListener('click', () => setLanguage('en'));
            document.getElementById('lang-es').addEventListener('click', () => setLanguage('es'));
            document.getElementById('lang-de').addEventListener('click', () => setLanguage('de'));
            
            // Afficher la page d'accueil après la sélection et le clic
            enterButton.addEventListener('click', () => {
                const selectedCode = zipCodeSelect.value;
                if (selectedCode) {
                    // Cacher la page de démarrage
                    startPage.classList.add('hidden');
                    // Afficher le conteneur principal
                    mainContent.classList.remove('hidden');

                    // Mettre à jour le titre de la ville
                    cityTitle.textContent = cityNames[selectedCode] || 'Destination Sud Réunion';
                }
            });

            // Retourner à la page de démarrage
            backButton.addEventListener('click', () => {
                mainContent.classList.add('hidden');
                startPage.classList.remove('hidden');
            });

            // Activer le bouton d'entrée lorsque le code postal est sélectionné
            zipCodeSelect.addEventListener('change', () => {
                enterButton.disabled = !zipCodeSelect.value;
            });
            
            // Logique du service worker pour le mode hors ligne (PWA)
            if ('serviceWorker' in navigator) {
                window.addEventListener('load', () => {
                    navigator.serviceWorker.register('/sw.js')
                        .then(registration => {
                            console.log('Service Worker enregistré avec succès:', registration);
                        })
                        .catch(err => {
                            console.log('Échec de l\'enregistrement du Service Worker:', err);
                        });
                });
            }
        });
    </script>
</body>
</html>
