<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hébergements</title>
    <!-- On inclut Tailwind pour un style plus moderne et cohérent avec l'application principale -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7fafc;
        }
        .airbnb-header {
            background-color: #ffffff;
            border-bottom: 1px solid #e2e8f0;
        }
        .main-title {
            color: #1a202c;
        }
        .filters-container {
            border-bottom: 1px solid #e2e8f0;
        }
        .filter-item {
            cursor: pointer;
            transition: transform 0.2s, color 0.2s;
        }
        .filter-item:hover {
            color: #38a169;
            transform: scale(1.05);
        }
        .filter-item.active {
            color: #38a169;
            border-bottom: 2px solid #38a169;
        }
        .card {
            background-color: #ffffff;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.2);
        }
        .card img {
            object-fit: cover;
        }
        .card-price {
            color: #38a169;
        }
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }
        .details-modal {
            background-color: white;
            padding: 2rem;
            border-radius: 1rem;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }
        .close-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            cursor: pointer;
            font-size: 1.5rem;
            font-weight: bold;
            color: #718096;
            transition: color 0.2s;
        }
        .close-btn:hover {
            color: #1a202c;
        }
        /* Style pour le bouton retour */
        .back-button {
            position: absolute;
            top: 2rem;
            left: 2rem;
            z-index: 50;
        }

        .back-button:hover {
            transform: scale(1.1);
        }
    </style>
</head>
<body class="bg-gray-100 font-sans">
    
    <!-- Bouton de retour -->
    <a href="index.html" class="back-button p-4 bg-white rounded-full shadow-lg transition transform hover:scale-105" aria-label="Retour à l'accueil">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-gray-700" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
        </svg>
    </a>

    <!-- Header avec barre de recherche et titre -->
    <header class="airbnb-header p-6 flex flex-col md:flex-row items-center justify-between shadow-sm">
        <h1 class="main-title text-3xl font-bold mb-4 md:mb-0">Hébergements</h1>
        <div class="search-bar w-full md:w-1/2">
            <input type="text" placeholder="Rechercher un hébergement..." id="searchInput" class="w-full p-3 rounded-full border border-gray-300 focus:outline-none focus:ring-2 focus:ring-emerald-500">
        </div>
    </header>

    <!-- Main Content -->
    <main class="p-6">
        <!-- Conteneur des filtres -->
        <div class="filters-container flex overflow-x-auto justify-start md:justify-center py-4 mb-6 space-x-6 whitespace-nowrap">
            <div class="filter-item flex flex-col items-center p-2 active" data-filter="all">
                <img src="https://img.icons8.com/ios-filled/24/globe.png" alt="Tous">
                <span>Tout</span>
            </div>
            <div class="filter-item flex flex-col items-center p-2" data-filter="chambres_d_hotes">
                <img src="https://img.icons8.com/ios-filled/24/bedroom.png" alt="Chambres d'hôtes">
                <span>Chambres d’hôtes</span>
            </div>
            <div class="filter-item flex flex-col items-center p-2" data-filter="hotels">
                <img src="https://img.icons8.com/ios-filled/24/hotel.png" alt="Hôtels">
                <span>Hôtels</span>
            </div>
            <div class="filter-item flex flex-col items-center p-2" data-filter="campings">
                <img src="https://img.icons8.com/ios-filled/24/camping-tent.png" alt="Campings">
                <span>Campings</span>
            </div>
            <div class="filter-item flex flex-col items-center p-2" data-filter="locations_saisonnieres">
                <img src="https://img.icons8.com/ios-filled/24/home-page.png" alt="Locations saisonnières">
                <span>Locations</span>
            </div>
        </div>

        <!-- Section des cartes d'hébergement -->
        <section id="hebergements-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
            <!-- Les cartes d'hébergement seront insérées ici dynamiquement -->
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-white p-6 mt-8 shadow-inner text-center">
        <div class="footer-container text-gray-600 text-sm">
            <p>&copy; 2025 Destination Sud Réunion. Tous droits réservés.</p>
            <p>Site réalisé par Clément Kaporal – Digital & Communication</p>
        </div>
    </footer>

    <!-- Modale pour afficher les détails de l'hébergement -->
    <div id="detailsModal" class="modal-overlay hidden">
        <div class="details-modal">
            <button onclick="closeModal()" class="close-btn" aria-label="Fermer la fenêtre modale">&times;</button>
            <div id="modalContent" class="flex flex-col md:flex-row gap-6">
                <div class="md:w-1/2">
                    <img id="modalPhoto" src="" alt="Hébergement" class="w-full h-auto rounded-lg shadow-md mb-4" />
                </div>
                <div class="md:w-1/2 flex flex-col justify-between">
                    <div>
                        <h2 id="modalTitle" class="text-3xl font-bold mb-2"></h2>
                        <p id="modalDescription" class="text-gray-700 mb-4"></p>
                    </div>
                    <div class="text-center md:text-left mt-auto">
                        <img id="modalQRCode" src="" alt="QR Code" class="w-32 h-32 mx-auto md:mx-0 mb-2" />
                        <p class="text-sm text-gray-500">Scannez pour plus d'infos</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Script JS -->
    <script>
        // Déclaration des données d'hébergement
        const hebergementsData = [
            {
                id: 1,
                name: "Villa Coco",
                description: "Villa luxueuse avec piscine privée et vue sur l'océan. Idéale pour les familles.",
                price: 250,
                rating: 4.8,
                photo: "https://placehold.co/600x400/87CEEB/ffffff?text=Villa+Coco",
                type: "locations_saisonnieres",
                address: "Rue des Cocotiers, 97410 Saint-Pierre",
                qrCode: "https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://www.destinationsudreunion.fr/villa-coco"
            },
            {
                id: 2,
                name: "Hôtel Le Récif",
                description: "Hôtel de charme en bord de mer, avec accès direct à la plage.",
                price: 180,
                rating: 4.5,
                photo: "https://placehold.co/600x400/87CEEB/ffffff?text=Hotel+Le+Recif",
                type: "hotels",
                address: "Avenue des Hôteliers, 97427 L'Étang-Salé",
                qrCode: "https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://www.destinationsudreunion.fr/hotel-le-recif"
            },
            {
                id: 3,
                name: "La Case à Paille",
                description: "Chambres d'hôtes traditionnelles, immersion totale dans la culture réunionnaise.",
                price: 80,
                rating: 4.9,
                photo: "https://placehold.co/600x400/87CEEB/ffffff?text=La+Case+a+Paille",
                type: "chambres_d_hotes",
                address: "Chemin des Goyaviers, 97425 Les Avirons",
                qrCode: "https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://www.destinationsudreunion.fr/la-case-a-paille"
            },
            {
                id: 4,
                name: "Camping du Volcan",
                description: "Camping avec emplacement ombragé au pied du Piton de la Fournaise.",
                price: 30,
                rating: 4.2,
                photo: "https://placehold.co/600x400/87CEEB/ffffff?text=Camping+du+Volcan",
                type: "campings",
                address: "Route du Volcan, 97480 Saint-Joseph",
                qrCode: "https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://www.destinationsudreunion.fr/camping-du-volcan"
            },
            {
                id: 5,
                name: "Bungalow Lagon Bleu",
                description: "Bungalow confortable avec vue sur le lagon, idéal pour les couples.",
                price: 120,
                rating: 4.7,
                photo: "https://placehold.co/600x400/87CEEB/ffffff?text=Bungalow+Lagon+Bleu",
                type: "locations_saisonnieres",
                address: "Boulevard du Lagon, 97436 Saint-Leu",
                qrCode: "https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://www.destinationsudreunion.fr/bungalow-lagon-bleu"
            },
            {
                id: 6,
                name: "Hôtel Les Jardins",
                description: "Établissement moderne avec spa et restaurant gastronomique.",
                price: 220,
                rating: 4.6,
                photo: "https://placehold.co/600x400/87CEEB/ffffff?text=Hotel+Les+Jardins",
                type: "hotels",
                address: "Rue des Fleurs, 97410 Saint-Pierre",
                qrCode: "https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://www.destinationsudreunion.fr/hotel-les-jardins"
            },
            {
                id: 7,
                name: "Maison d'hôtes Ti Kaz",
                description: "Petite maison créole chaleureuse, ambiance familiale garantie.",
                price: 75,
                rating: 4.9,
                photo: "https://placehold.co/600x400/87CEEB/ffffff?text=Maison+d'hotes+Ti+Kaz",
                type: "chambres_d_hotes",
                address: "Allée des Palmistes, 97416 Entre-Deux",
                qrCode: "https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://www.destinationsudreunion.fr/ti-kaz"
            },
            {
                id: 8,
                name: "Camping La Plage",
                description: "Emplacements en bord de mer, idéal pour les amoureux de la nature.",
                price: 35,
                rating: 4.3,
                photo: "https://placehold.co/600x400/87CEEB/ffffff?text=Camping+La+Plage",
                type: "campings",
                address: "Route du Littoral, 97427 L'Étang-Salé",
                qrCode: "https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://www.destinationsudreunion.fr/camping-la-plage"
            },
        ];

        document.addEventListener('DOMContentLoaded', () => {
            const container = document.getElementById('hebergements-container');
            const searchInput = document.getElementById('searchInput');
            const filterItems = document.querySelectorAll('.filter-item');
            const modal = document.getElementById('detailsModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalDescription = document.getElementById('modalDescription');
            const modalPhoto = document.getElementById('modalPhoto');
            const modalQRCode = document.getElementById('modalQRCode');

            let currentFilter = 'all';

            // Fonction pour afficher les hébergements
            const renderHebergements = (data) => {
                container.innerHTML = ''; // Vide le conteneur existant
                const userZipCode = localStorage.getItem('kiosk-zip-code');
                
                const filteredData = data.filter(item => {
                    const isTypeMatch = currentFilter === 'all' || item.type === currentFilter;
                    const isSearchMatch = searchInput.value === '' || item.name.toLowerCase().includes(searchInput.value.toLowerCase()) || item.description.toLowerCase().includes(searchInput.value.toLowerCase());
                    const isZipCodeMatch = userZipCode === '' || item.address.includes(userZipCode);
                    return isTypeMatch && isSearchMatch && isZipCodeMatch;
                });
                
                if (filteredData.length === 0) {
                    container.innerHTML = '<p class="text-center text-xl text-gray-500 col-span-full">Aucun hébergement trouvé pour votre recherche.</p>';
                    return;
                }

                filteredData.forEach(hebergement => {
                    const card = document.createElement('div');
                    card.className = 'card rounded-xl overflow-hidden shadow-lg p-4 flex flex-col items-center';
                    card.innerHTML = `
                        <img src="${hebergement.photo}" alt="${hebergement.name}" class="w-full h-48 object-cover rounded-lg mb-4">
                        <div class="p-2 w-full text-center">
                            <h2 class="font-bold text-xl mb-2">${hebergement.name}</h2>
                            <p class="text-gray-700 text-base mb-2">${hebergement.description}</p>
                            <p class="card-price font-bold text-lg text-emerald-600 mb-2">${hebergement.price} € / nuit</p>
                            <div class="flex items-center justify-center">
                                <svg class="w-4 h-4 text-yellow-400 mr-1" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.691-.921 1.99 0l1.205 3.71c.17.525.666.883 1.21.883h3.9c.963 0 1.35.792.54 1.341l-3.153 2.29c-.48.349-.672.969-.49 1.5l1.205 3.71c.3.921-.368 1.48-1.157.91l-3.153-2.29c-.48-.349-1.12-.349-1.6 0l-3.153 2.29c-.79.57-1.457.011-1.157-.91l1.205-3.71c.182-.531-.01-1.151-.49-1.5L2.593 8.851c-.81-.549-.423-1.48.54-1.341h3.9c.544 0 1.04-.358 1.21-.883l1.205-3.71z"/></svg>
                                <span class="text-gray-600 text-sm">${hebergement.rating}</span>
                            </div>
                        </div>
                    `;
                    card.addEventListener('click', () => showDetails(hebergement));
                    container.appendChild(card);
                });
            };

            // Fonction pour afficher la modale
            const showDetails = (hebergement) => {
                modalTitle.textContent = hebergement.name;
                modalDescription.textContent = hebergement.description;
                modalPhoto.src = hebergement.photo;
                modalQRCode.src = hebergement.qrCode;
                modal.classList.remove('hidden');
                document.body.style.overflow = 'hidden'; // Empêche le défilement du corps
            };

            // Fonction pour fermer la modale
            window.closeModal = () => {
                modal.classList.add('hidden');
                document.body.style.overflow = ''; // Réactive le défilement
            };
            
            // Gestion des filtres
            filterItems.forEach(item => {
                item.addEventListener('click', () => {
                    filterItems.forEach(i => i.classList.remove('active'));
                    item.classList.add('active');
                    currentFilter = item.dataset.filter;
                    renderHebergements(hebergementsData);
                });
            });

            // Gestion de la recherche
            searchInput.addEventListener('input', () => {
                renderHebergements(hebergementsData);
            });

            // Affichage initial
            renderHebergements(hebergementsData);
        });
    </script>
</body>
</html>
